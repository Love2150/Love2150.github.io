name: Update cyber tips

on:
  schedule:
    # run every 2 hours (adjust if you like)
    - cron: "0 */2 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-tips:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          # fetch full history so rebase works properly
          fetch-depth: 0

      # ðŸ”¹ Make sure weâ€™re up to date with origin/main
      - name: Sync with remote main
        run: |
          git fetch origin main
          git checkout main
          git pull --rebase origin main

      # ðŸ”¹ Your script or command that updates assets/tips.json
      # (Replace this with whatever actually generates tips.json)
      - name: Generate latest tips.json
        run: |
          echo "TODO: generate tips.json here"
          # example placeholder just touches the file:
          # python scripts/update_tips.py

      # ðŸ”¹ Auto-commit just tips.json back to main
      - name: Commit updated tips.json
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          branch: main                # <â€” IMPORTANT: explicitly push to main
          file_pattern: assets/tips.json
          commit_message: "chore: update tips.json"
